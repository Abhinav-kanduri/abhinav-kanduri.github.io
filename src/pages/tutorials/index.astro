---
import Layout from '../../layouts/Layout.astro';

// Grab every .md in this folder, eager-load frontmatter
const tutorialModules = import.meta.glob('./*.md', { eager: true });

// Build an array of { slug, title, description, pubDate }, sorted newest first
const tutorials = Object.entries(tutorialModules)
  .map(([path, mod]) => {
    const slug = path.replace(/^\.\/(.*)\.md$/, '$1');
    const { title, description, pubDate } = mod.frontmatter;
    return { slug, title, description, pubDate: new Date(pubDate) };
  })
  .sort((a, b) => b.pubDate - a.pubDate);
---
<Layout title="Tutorials">
  <h1 class="text-4xl font-bold mb-8">Tutorials</h1>
  <ul class="space-y-6">
    {tutorials.map(t => (
      <li>
        <a href={`/tutorials/${t.slug}`} class="text-2xl font-semibold text-accent-600 hover:underline">
          {t.title}
        </a>
        {t.description && <p class="text-gray-600">{t.description}</p>}
        <time class="text-sm text-gray-500">{t.pubDate.toDateString()}</time>
      </li>
    ))}
  </ul>
</Layout>
